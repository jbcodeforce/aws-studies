<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.5.3"><title>AWS Studies</title><link rel=stylesheet href=assets/stylesheets/main.7a952b86.min.css><link rel=stylesheet href=assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#2094f3><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=extra.css><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#amazon-web-service-studies class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=. title="AWS Studies" class="md-header__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AWS Studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Introduction </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/aws-studies.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=. title="AWS Studies" class="md-nav__button md-logo" aria-label="AWS Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> AWS Studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/aws-studies.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Introduction <span class="md-nav__icon md-icon"></span> </label> <a href=. class="md-nav__link md-nav__link--active"> Introduction </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#why-cloud class=md-nav__link> Why cloud </a> </li> <li class=md-nav__item> <a href=#use-cases class=md-nav__link> Use cases </a> </li> <li class=md-nav__item> <a href=#infrastructure class=md-nav__link> Infrastructure </a> </li> <li class=md-nav__item> <a href=#interact-with-aws class=md-nav__link> Interact with AWS </a> </li> <li class=md-nav__item> <a href=#organization class=md-nav__link> Organization </a> </li> <li class=md-nav__item> <a href=#iam-identity-and-access-management class=md-nav__link> IAM Identity and Access Management </a> <nav class=md-nav aria-label="IAM Identity and Access Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#iam-roles class=md-nav__link> IAM Roles </a> </li> <li class=md-nav__item> <a href=#security-tools class=md-nav__link> Security tools </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#aws-cli class=md-nav__link> AWS CLI </a> </li> <li class=md-nav__item> <a href=#relational-database-service-rds class=md-nav__link> Relational Database Service - RDS </a> </li> <li class=md-nav__item> <a href=#aurora class=md-nav__link> Aurora </a> </li> <li class=md-nav__item> <a href=#elasticache class=md-nav__link> ElastiCache </a> </li> <li class=md-nav__item> <a href=#dynamodb class=md-nav__link> DynamoDB </a> </li> <li class=md-nav__item> <a href=#route-53 class=md-nav__link> Route 53 </a> <nav class=md-nav aria-label="Route 53"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cname-vs-alias class=md-nav__link> CNAME vs Alias </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> Routing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-application-patterns class=md-nav__link> Some application patterns </a> <nav class=md-nav aria-label="Some application patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stateless-app class=md-nav__link> Stateless App </a> </li> <li class=md-nav__item> <a href=#stateful-app class=md-nav__link> Stateful app </a> </li> <li class=md-nav__item> <a href=#deploying-app class=md-nav__link> Deploying app </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#s3 class=md-nav__link> S3 </a> <nav class=md-nav aria-label=S3> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-cases_1 class=md-nav__link> Use cases </a> </li> <li class=md-nav__item> <a href=#security-control class=md-nav__link> Security control </a> </li> <li class=md-nav__item> <a href=#s3-website class=md-nav__link> S3 Website </a> </li> <li class=md-nav__item> <a href=#s3-storage-classes class=md-nav__link> S3 Storage classes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#aws-athena class=md-nav__link> AWS Athena </a> </li> <li class=md-nav__item> <a href=#aws-cli_1 class=md-nav__link> AWS CLI </a> </li> <li class=md-nav__item> <a href=#cloudfront class=md-nav__link> CloudFront </a> </li> <li class=md-nav__item> <a href=#storage class=md-nav__link> Storage </a> <nav class=md-nav aria-label=Storage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#snowball class=md-nav__link> Snowball </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hybrid-cloud-storage class=md-nav__link> Hybrid cloud storage </a> <nav class=md-nav aria-label="Hybrid cloud storage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#storage-comparison class=md-nav__link> Storage comparison </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integration-and-middleware-sqs-kinesis-active-mq class=md-nav__link> Integration and middleware: SQS, Kinesis Active MQ </a> <nav class=md-nav aria-label="Integration and middleware: SQS, Kinesis Active MQ"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sqs-standard-queue class=md-nav__link> SQS: Standard queue </a> </li> <li class=md-nav__item> <a href=#simple-notification-service-is-for-topic-pubsub class=md-nav__link> Simple Notification Service is for topic pub/sub </a> </li> <li class=md-nav__item> <a href=#kinesis class=md-nav__link> Kinesis </a> </li> <li class=md-nav__item> <a href=#eventbridge class=md-nav__link> EventBridge </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#serverless class=md-nav__link> Serverless </a> <nav class=md-nav aria-label=Serverless> <ul class=md-nav__list> <li class=md-nav__item> <a href=#serverless-architecture-patterns class=md-nav__link> Serverless architecture patterns </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other-database-considerations class=md-nav__link> Other Database considerations </a> <nav class=md-nav aria-label="Other Database considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#redshift class=md-nav__link> Redshift </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=infra/ class=md-nav__link> Infrastructure </a> </li> <li class=md-nav__item> <a href=gettingstarted/ class=md-nav__link> Playground </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Solution architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Solution architecture" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Solution architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=sa/well-architectured/ class=md-nav__link> Well Architectured </a> </li> <li class=md-nav__item> <a href=sa/sol-design/ class=md-nav__link> Solution design </a> </li> <li class=md-nav__item> <a href=sa/psa-role/ class=md-nav__link> SA </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Serverless <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Serverless data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Serverless </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=serverless/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=serverless/k8s/ class=md-nav__link> Kubernetes services </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io class=md-nav__link> Return to main </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#why-cloud class=md-nav__link> Why cloud </a> </li> <li class=md-nav__item> <a href=#use-cases class=md-nav__link> Use cases </a> </li> <li class=md-nav__item> <a href=#infrastructure class=md-nav__link> Infrastructure </a> </li> <li class=md-nav__item> <a href=#interact-with-aws class=md-nav__link> Interact with AWS </a> </li> <li class=md-nav__item> <a href=#organization class=md-nav__link> Organization </a> </li> <li class=md-nav__item> <a href=#iam-identity-and-access-management class=md-nav__link> IAM Identity and Access Management </a> <nav class=md-nav aria-label="IAM Identity and Access Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#iam-roles class=md-nav__link> IAM Roles </a> </li> <li class=md-nav__item> <a href=#security-tools class=md-nav__link> Security tools </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#aws-cli class=md-nav__link> AWS CLI </a> </li> <li class=md-nav__item> <a href=#relational-database-service-rds class=md-nav__link> Relational Database Service - RDS </a> </li> <li class=md-nav__item> <a href=#aurora class=md-nav__link> Aurora </a> </li> <li class=md-nav__item> <a href=#elasticache class=md-nav__link> ElastiCache </a> </li> <li class=md-nav__item> <a href=#dynamodb class=md-nav__link> DynamoDB </a> </li> <li class=md-nav__item> <a href=#route-53 class=md-nav__link> Route 53 </a> <nav class=md-nav aria-label="Route 53"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cname-vs-alias class=md-nav__link> CNAME vs Alias </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> Routing </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-application-patterns class=md-nav__link> Some application patterns </a> <nav class=md-nav aria-label="Some application patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stateless-app class=md-nav__link> Stateless App </a> </li> <li class=md-nav__item> <a href=#stateful-app class=md-nav__link> Stateful app </a> </li> <li class=md-nav__item> <a href=#deploying-app class=md-nav__link> Deploying app </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#s3 class=md-nav__link> S3 </a> <nav class=md-nav aria-label=S3> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-cases_1 class=md-nav__link> Use cases </a> </li> <li class=md-nav__item> <a href=#security-control class=md-nav__link> Security control </a> </li> <li class=md-nav__item> <a href=#s3-website class=md-nav__link> S3 Website </a> </li> <li class=md-nav__item> <a href=#s3-storage-classes class=md-nav__link> S3 Storage classes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#aws-athena class=md-nav__link> AWS Athena </a> </li> <li class=md-nav__item> <a href=#aws-cli_1 class=md-nav__link> AWS CLI </a> </li> <li class=md-nav__item> <a href=#cloudfront class=md-nav__link> CloudFront </a> </li> <li class=md-nav__item> <a href=#storage class=md-nav__link> Storage </a> <nav class=md-nav aria-label=Storage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#snowball class=md-nav__link> Snowball </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hybrid-cloud-storage class=md-nav__link> Hybrid cloud storage </a> <nav class=md-nav aria-label="Hybrid cloud storage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#storage-comparison class=md-nav__link> Storage comparison </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integration-and-middleware-sqs-kinesis-active-mq class=md-nav__link> Integration and middleware: SQS, Kinesis Active MQ </a> <nav class=md-nav aria-label="Integration and middleware: SQS, Kinesis Active MQ"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sqs-standard-queue class=md-nav__link> SQS: Standard queue </a> </li> <li class=md-nav__item> <a href=#simple-notification-service-is-for-topic-pubsub class=md-nav__link> Simple Notification Service is for topic pub/sub </a> </li> <li class=md-nav__item> <a href=#kinesis class=md-nav__link> Kinesis </a> </li> <li class=md-nav__item> <a href=#eventbridge class=md-nav__link> EventBridge </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#serverless class=md-nav__link> Serverless </a> <nav class=md-nav aria-label=Serverless> <ul class=md-nav__list> <li class=md-nav__item> <a href=#serverless-architecture-patterns class=md-nav__link> Serverless architecture patterns </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other-database-considerations class=md-nav__link> Other Database considerations </a> <nav class=md-nav aria-label="Other Database considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#redshift class=md-nav__link> Redshift </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/jbcodeforce/aws-studies.git/edit/master/docs/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=amazon-web-service-studies>Amazon Web Service Studies<a class=headerlink href=#amazon-web-service-studies title="Permanent link">&para;</a></h1> <ul> <li>Created in 2002, and launched as AWS in 2004 with SQS as first service offering. </li> <li>2003 amazon.com was $5.2B retail businesses. 7800 employees</li> </ul> <h2 id=why-cloud>Why cloud<a class=headerlink href=#why-cloud title="Permanent link">&para;</a></h2> <ul> <li>moving from capex to variable expense</li> <li>economy of scale: EC2 instance with different pricing model. Usage from hundreds of thousands of customers is aggregated in the cloud</li> <li>Elactic capacity: pay for what you use. Scale up and down so no need to guessed capacity.</li> <li>Speed and agility to define infrastructure in minutes not weeks</li> <li>Focus on business apps, not IT infrastructure and data centers.</li> <li>Global reach in a minutes</li> </ul> <h2 id=use-cases>Use cases<a class=headerlink href=#use-cases title="Permanent link">&para;</a></h2> <ul> <li>Enable to build scalable apps, adaptable to business demand</li> <li>Extend Enterprise IT</li> <li>Support flexible big data analytics</li> </ul> <h2 id=infrastructure>Infrastructure<a class=headerlink href=#infrastructure title="Permanent link">&para;</a></h2> <p>AWS is a <a href=https://infrastructure.aws>global infrastructure</a> with 27 regions and 2 to 6 availability zones per region. Ex: us-west-1-2a. </p> <p>AZ is one or more DC with redundant power, networking and connectivity. Isolated from disasters. Interconnected with low latency network. </p> <p>AWS services are local or global:</p> <ul> <li>EC2 is a regional service. Region-scoped services come with availabiltiy and resiliency. </li> <li>IAM is a global service.</li> </ul> <p><strong>AWS Local Zone</strong> location is an extension of an AWS Region where you can run your latency sensitive application in geography close to end-users.</p> <p><strong>AWS Wavelength</strong> enables developers to build applications that deliver single-digit millisecond latencies to mobile devices and end-users. AWS infrastructure deployments that embed AWS compute and storage services within the telecommunications providers’ datacenters at the edge of the 5G networks, and seamlessly access the breadth of AWS services in the region.</p> <p>Choose an AWS region, depending of your requirements like:</p> <ul> <li>compliance with data governance and legal requirements</li> <li>close to users to reduce latency</li> <li><a href=https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/ >availability of service within a region</a> </li> <li>pricing</li> </ul> <h2 id=interact-with-aws>Interact with AWS<a class=headerlink href=#interact-with-aws title="Permanent link">&para;</a></h2> <ul> <li>Management console: services are placed in categories: compute, serverless, database, analytics...</li> <li><a href=https://aws.amazon.com/cli/ >CLI</a></li> <li><a href=https://aws.amazon.com/developer/tools/ >SDK</a> for C++, Go, Java, JavaScript, .NET, Node.js, PHP, Python, and Ruby</li> </ul> <h2 id=organization>Organization<a class=headerlink href=#organization title="Permanent link">&para;</a></h2> <p>When you work with the AWS Cloud, managing security and compliance is a <a href=https://aws.amazon.com/compliance/shared-responsibility-model/ >shared responsibility</a> between AWS and you:</p> <ul> <li>aws is the security <strong>of</strong> the cloud</li> <li>you are responsible for the security <strong>in</strong> the cloud: secure workloads and applications that you deploy onto the cloud.</li> </ul> <p>Helps to group accounts, and simplify account creation. Consolidate billing.</p> <p>Concepts:</p> <ul> <li>root user: a single sign-in identity that has complete access to all AWS services and resources in the account</li> <li>Organization unit (OU)</li> <li>account be part of 1 OU</li> <li>Define service control policies</li> </ul> <p><a href="https://us-east-1.console.aws.amazon.com/organizations/v2/home?region=us-east-1#">Organization console</a></p> <h2 id=iam-identity-and-access-management>IAM Identity and Access Management<a class=headerlink href=#iam-identity-and-access-management title="Permanent link">&para;</a></h2> <ul> <li>This is global services so defined at the account level and cross regions</li> <li>Define user (physical person), group and roles, and permissions</li> <li>Do not use root user, but create user and always use them when login. <code>jerome</code> and <code>mathieu</code> are users</li> <li>get user as administrator, meaning it will be part of an admin group with admin priviledges, like <code>AdmintratorAccess</code></li> <li>Assign users to groups (<code>admin</code> and <code>developers</code>) and assign policies to groups and not to individual user.</li> <li>Groups can only contain users, not other groups</li> <li> <p>Users can belong to multiple groups</p> </li> <li> <p>Users are defined as global service encompasses all regions</p> </li> <li>AWS Account has a unique ID but can be set with an alias (e.g.<code>jbcodeforce</code>) so to sign in to the console the URL becomes <a href=https://jbcodeforce.signin.aws.amazon.com/console>https://jbcodeforce.signin.aws.amazon.com/console</a></li> <li>Policies are written in JSON, to define permissions <code>Allow</code>, <code>Deny</code> for users to access AWS services, groups and roles</li> <li>Policy applies to Principal: account/user/role, list the actions (what is allowed or denied) on the given resources</li> <li>Least privilege permission: Give users the minimal amount of permissions they need to do their job</li> <li>Policy is a json doc:</li> </ul> <div class=highlight><pre><span></span><code><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=nt>&quot;Version&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2012-10-17&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>    </span><span class=nt>&quot;Statement&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=nt>&quot;Effect&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Allow&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>            </span><span class=nt>&quot;Action&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w></span>
<span class=w>                </span><span class=s2>&quot;iam:List*&quot;</span><span class=w></span>
<span class=w>            </span><span class=p>],</span><span class=w></span>
<span class=w>            </span><span class=nt>&quot;Resource&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;*&quot;</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>]</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> <ul> <li>Policy can define the password type <code>&gt; Account settings &gt; Password policy</code>, and when users are allowed to change the password.</li> <li>Multi Factor Authentication - always protect root account. MFA = password + device we own. The device could be a universal 2<sup>nd</sup> factor security key. (ubikey) </li> <li>Authy is a multi-device service. We can have multiple users on the same device</li> <li>IAM is not used for website authentication and authorization</li> <li>For identity federation, SAML standard is used</li> </ul> <h3 id=iam-roles>IAM Roles<a class=headerlink href=#iam-roles title="Permanent link">&para;</a></h3> <ul> <li>To get AWS services doing work on other service, we use IAM Role. Roles are assigned per application, or EC2 or lambda function...</li> </ul> <p><img alt src=images/iam-roles.png></p> <ul> <li> <p>Maintaining roles is more efficient than maintaining users. When you assume a role, IAM dynamically provides temporary credentials that expire after a defined period of time, between 15 minutes and 36 hours.</p> </li> <li> <p>When connected to an EC2 machine via ssh or using EC2 instance connect, we need to set the IAM roles for who can use the EC2. A command like <code>aws iam list-users</code> will not work until a role it attached.</p> </li> </ul> <p>To authorize access to a EC2 instance, we use IAM Roles. The DemoEC2Role, for example, is defined to access EC2 in read only:</p> <p><img alt src=images/aws-iam-role.png></p> <p>This role is then defined in the EC2 / Security &gt; attach IAM role.</p> <h3 id=security-tools>Security tools<a class=headerlink href=#security-tools title="Permanent link">&para;</a></h3> <ul> <li>In IAM, use <code>&gt; Credentials report</code> to download account based report.</li> <li>In IAM, use <code>&gt; Users &gt; select one user (jerome) and then Access Advisor</code>: Access Advisor shows the services that this user can access and when those services were last accessed</li> </ul> <h2 id=aws-cli>AWS CLI<a class=headerlink href=#aws-cli title="Permanent link">&para;</a></h2> <p>We can access AWS using the CLI or the SDK which both use access keys generated from the console (&gt; Users &gt; jerome &gt; Security credentials &gt; Access Keys).</p> <p>The keys are saved in <code>~/.aws/credentials</code></p> <p><a href=https://github.com/aws/aws-cli/tree/v2>aws-cli version 2</a></p> <div class=highlight><pre><span></span><code>aws --version
<span class=c1># get your users</span>
aws iam list-users
</code></pre></div> <p>With Cloudshell we can use aws cli and then have file that will be kept in the filesystems of the cloud shell.</p> <p>[aws-shell] is also available to facilitate the user experience.</p> <h2 id=relational-database-service-rds>Relational Database Service - RDS<a class=headerlink href=#relational-database-service-rds title="Permanent link">&para;</a></h2> <p>Managed service for SQL based database (mySQL, Postgresql, SQL server, Oracle). Must provision EC2 instance and EBS volume. Support multi AZs for DR with automatic failover to standby, app uses one unique DNS name. Continuous backup and restore to specific point of time restore. It uses gp2 or io1 EBS. Transaction logs are backed-up every 5 minutes. Support user triggered snapshot.</p> <ul> <li>Read replicas: helps to scale the read operations. Can create up to 5 replicas within AZ, cross AZ and cross region. Replication is asynch. Use cases include, reporting, analytics, ML model</li> <li>AWS charge for network when for example data goes from one AZ to another.</li> <li>Support at rest Encryption. Master needs to be encrypted to get encrypted replicas. </li> <li>We can create a snapshot from unencrypted DB and then copy it by enabling the encryption for this snapshot. From there we can create an Encrypted DB</li> </ul> <p>Our responsibility:</p> <ul> <li>Check the ports / IP / security group inbound rules in DB’s SG</li> <li>In-database user creation and permissions or manage through IAM</li> <li>Creating a database with or without public access</li> <li>Ensure parameter groups or DB is configured to only allow SSL connections</li> </ul> <p>From a solution architecture point of view:</p> <ul> <li><strong>Operations</strong>: small downtime when failover happens. For maintenance, scaling in read replicas, updating underlying ec2 instance, or restore EBS, there will be manual intervention.</li> <li><strong>Security</strong>: AWS responsible for OS security, we are responsible for setting up KMS, security groups, IAM policies, authorizing users in DB, enforcing SSL.</li> <li><strong>Reliability</strong>: Multi AZ feature helps to address it, with failover mechanism in case of failures</li> <li><strong>Performance</strong>: depends on EC2 instance type, EBS volume type, ability to add Read Replicas. Doesn’t auto-scale, adapt to workload manually. </li> </ul> <h2 id=aurora>Aurora<a class=headerlink href=#aurora title="Permanent link">&para;</a></h2> <p>Proprietary SQL database, work using postgresql and mysql driver. It is cloud optimized and claims 5x performance improvement over mySQL on RDS, and 3x for postgresql. </p> <p>Can grow up to 64 TB. Sub 10ms replica lag, up to 15 replicas.</p> <p>Failover in Aurora is instantaneous. It’s HA (High Availability) native. Use 1 master - 5 readers to create 6 copies over 3 AZs. 3 copies of 6 need for reads. Peer to peer replication. Use 100s volumes. Autoscaling on the read operation. </p> <p><img alt=6 src=images/aws-aurora.png></p> <p>It is CQRS at DB level, and read can be global. Use writer end point and reader endpoint.</p> <p>It also supports one write with multiple reader and parallel query, multiple writes and serverless to automate scaling down to zero (No capacity planning needed and pay per second).</p> <p>With Aurora global database one primary region is used for write and then up to 5 read only regions with replica lag up to 1 s. Promoting another region (for disaster recovery) has an RTO of &lt; 1 minute</p> <ul> <li><strong>Operations</strong>: less operation, auto scaling storage.</li> <li><strong>Security</strong>: AWS responsible for OS security, we are responsible for setting up KMS, security groups, IAM policies, authorizing users in DB, enforcing SSL.</li> <li><strong>Reliability</strong>: Multi AZ, HA</li> <li><strong>Performance</strong>: 5x performance, up to 15 read replicas.</li> </ul> <h2 id=elasticache>ElastiCache<a class=headerlink href=#elasticache title="Permanent link">&para;</a></h2> <p>Get a managed Redis or Memcached cluster. Applications queries ElastiCache, if not available, get from RDS and store in ElastiCache. Key-Value store. It can be used for user session store so user interaction can go to different application instances.</p> <p><strong>Redis</strong> is a multi AZ with Auto-Failover, supports read replicas to scale and for high availability. It can persist data using AOF persistence, and has backup and restore features.</p> <p><strong>Memcached</strong> is a multi-node for partitioning of data (sharding), and no persistence, no backup and restore. It is based on a multi-threaded architecture.</p> <p>Some patterns for ElastiCache:</p> <ul> <li><strong>Lazy Loading</strong>: all the read data is cached, data can become stale in cache</li> <li><strong>Write Through</strong>: Adds or update data in the cache when written to a DB (no stale data)</li> <li><strong>Session Store</strong>: store temporary session data in a cache (using TTL features)</li> </ul> <p>Sub millisecond performance, in memory read replicas for sharding. </p> <h2 id=dynamodb>DynamoDB<a class=headerlink href=#dynamodb title="Permanent link">&para;</a></h2> <p>AWS proprietary NoSQL database, Serverless, provisioned capacity, auto scaling, on demand capacity. Highly Available, Multi AZ by default, Read and Writes are decoupled, and DAX can be used for read cache. </p> <p>The read operations can be eventually consistent or strongly consistent.</p> <p>DynamoDB Streams to integrate with AWS Lambda.</p> <h2 id=route-53>Route 53<a class=headerlink href=#route-53 title="Permanent link">&para;</a></h2> <p>It is a managed Domain Name System. DNS is a collection of rules and records which helps clients understand how to reach a server through URLs. Here is a quick figure to summary the process</p> <p><img alt=7 src=images/dns.png></p> <p>DNS records Time to Live (TTL), is set to get the web browser to keep the DNS resolution in cache. High TTL is around 24 hours, low TTL at 60s will make more DNS calls. TTL should be set to strike a balance between how long the value should be cached vs how much pressure should go on the DNS. Need to define the TTL for the app depending on the expected deployment model.</p> <p>A hosted zone is a container that holds information about how we want to route traffic for a domain. Two types are supported: public or private within a VPC.</p> <p>Route 53 is a registrar. We can buy domain name.</p> <p>Use <code>dig &lt;hostname&gt;</code> to get the DNS resolution record.</p> <h3 id=cname-vs-alias>CNAME vs Alias<a class=headerlink href=#cname-vs-alias title="Permanent link">&para;</a></h3> <p><a href=https://en.wikipedia.org/wiki/CNAME_record>CNAME</a> is a DNS record to maps one domain name to another. CNAME should point to a ALB. <strong>Alias</strong> is used to point a hostname of an AWS resource and can work on root domain (domainname.com).</p> <h3 id=routing>Routing<a class=headerlink href=#routing title="Permanent link">&para;</a></h3> <p>A simple routing policy to get an IP @ from a hostname could not have health check defined. </p> <p>The <strong>weighted</strong> routing policy controls the % of the requests that go to specific endpoint. Can do blue-green traffic management. It can also help to split traffic between two regions. It can be associated with Health Checks</p> <p>The <strong>latency</strong> routing Policy redirects to the server that has the least latency close to the client. Latency is evaluated in terms of user to designated AWS Region.</p> <p><strong>Health check</strong> monitors the health and performance of the app servers or endpoints and assess DNS failure. We can have HTTP, TCP or HTTPS health checks. We can define from which region to run the health check. They are charged per HC / month. It is recommended to have one HC per app deployment. It can also monitor latency.</p> <p>The <strong>failover</strong> routing policy helps us to specify a record set to point to a primary and then a secondary instance for DR. </p> <p>The <strong>Geo Location</strong> routing policy is based on user's location, and we may specify how the traffic from a given country should go to this specific IP. Need to define a “default” policy in case there’s no match on location.</p> <p>The <strong>Multi Value</strong> routing policy is used to access multiple resources. The record set, associates a Route 53 health checks with records. The client on DNS request gets up to 8 healthy records returned for each Multi Value query. If one fails then the client can try one other IIP @ from the list.</p> <h2 id=some-application-patterns>Some application patterns<a class=headerlink href=#some-application-patterns title="Permanent link">&para;</a></h2> <p>For solution architecture, we need to assess cost, performance, reliability, security and operational excellence.</p> <h3 id=stateless-app>Stateless App<a class=headerlink href=#stateless-app title="Permanent link">&para;</a></h3> <p>The step to grow a stateless app: add vertical scaling by changing the EC2 profile, but while changing, user has out of service. Second step is to scale horizontal, each EC2 instance has static IP address and DNS is configured with 'A record' to get each EC2 end point. But if one instance is gone, the client App will see it down until TTL expires.</p> <p>The reference architecture includes DNS record set with alias record (to point to ALB. Using alias as ALB address may change over time) with TTL of 1 hour. Use load balancers in 3 AZs (to survive disaster) to hide the horizontal scaling of EC2 instances (managed with auto scaling group) where the app runs. Health checks are added to keep system auto adaptable and hide system down, and restricted security group rules to control EC2 instance accesses. ALB and EC instances are in multi different AZs. The EC instances can be set up with reserved capacity to control cost.</p> <p><img alt=8 src=images/stateless-app.png></p> <h3 id=stateful-app>Stateful app<a class=headerlink href=#stateful-app title="Permanent link">&para;</a></h3> <p>In this case we will add the pattern of shopping cart. If we apply the same architecture as before, at each interaction of the user, it is possible the traffic will be sent to another EC2 instance that started to process the shopping cart. Using ELB with stickiness will help to keep the traffic to the same EC2, but in case of EC2 failure we still loose the cart. An alternate is to use user cookies to keep the cart at each interaction. It is back to a stateless app as state is managed by client and cookie. For security reason the app needs to validate the cookie content. cookie has a limit of 4K data.</p> <p>Another solution is to keep session data into an elastic cache, like Redis, and use the sessionId as key and persisted in a user cookie. So EC2 managing the interaction can get the cart data from the cache using the sessionID. It can be enhanced with a RDS to keep user data. Which can also support the CQRS pattern with read replicas. Cache can be update with data from RDS so if the user is requesting data in session, it hits the cache.</p> <p><img alt=9 src=images/stateful-app.png></p> <p>Cache and database are set on multi AZ, as well as EC2 instance and load balancer, all to support disaster. Security groups need to be defined to get all traffic to the ELB and limited traffic between ELB and EC2 and between EC2 and cache and EC2 and DB.</p> <p>Another example of stateful app is the ones using image stored on disk. In this case EC2 EBS volume will work only for one app instance, but for multi app scaling out, we need to have a Elastic FS which can be Multi AZ too.</p> <h3 id=deploying-app>Deploying app<a class=headerlink href=#deploying-app title="Permanent link">&para;</a></h3> <p>The easiest solution is to create AMI containing OS, dependencies and app binary. This is completed with User Data to get dynamic configuration. Database data can be restored from Snapshot, and the same for EFS data.</p> <p><a href=https://aws.amazon.com/elasticbeanstalk/ >Elastic Beanstalk</a> is a developer centric view of the app, hiding the complexity of the IaaS. From one git repository it can automatically handle the deployment details of capacity provisioning, load balancing, auto-scaling, and application health monitoring. </p> <h2 id=s3>S3<a class=headerlink href=#s3 title="Permanent link">&para;</a></h2> <p><a href="https://s3.console.aws.amazon.com/s3/get-started?region=us-west-1">Amazon S3</a> allows people to store objects (files) in <strong>buckets</strong> (directories), which must have a globally unique name (cross users!). They are defined at the region level. <strong>Object</strong> in a bucket, is referenced as a <strong>key</strong> which can be seen as a file path in a file system. The max size for an object is 5 TB but big file needs to be uploaded in multipart using 5GB max size.</p> <p>S3 supports versioning at the bucket level. So file can be restored from previous version, and even deleted file can be retrieved from a previous version.</p> <h3 id=use-cases_1>Use cases<a class=headerlink href=#use-cases_1 title="Permanent link">&para;</a></h3> <ul> <li>Backup and restore</li> <li>DR</li> <li>Archive</li> <li><a href=https://aws.amazon.com/big-data/datalakes-and-analytics/ >Data lakes</a></li> <li>Hybrid cloud storage: seamless connection between on-premises applications and S3 with AWS Storage Gateway.</li> <li>Cloud-native application data</li> </ul> <p><a href=https://docs.aws.amazon.com/AmazonS3/latest/userguide/GetStartedWithS3.html>GETTIG started</a></p> <h3 id=security-control>Security control<a class=headerlink href=#security-control title="Permanent link">&para;</a></h3> <p>Objects can also be encrypted, and different mechanisms are available:</p> <ul> <li><strong>SSE-S3</strong>: server-side encrypted S3 objects using keys handled &amp; managed by AWS using AES-256 protocol must set <code>x-amz-server-side-encryption: "AES256"</code> header in the POST request.</li> <li><strong>SSE-KMS</strong>: leverage AWS Key Management Service to manage encryption keys. <code>x-amz-server-side-encryption: "aws:kms"</code> header. Server side encrypted. It gives user control of the key rotation policy and audit trail.</li> <li><strong>SSE-C</strong>: when we want to manage our own encryption keys. Server-side encrypted. Encryption key must be provided in HTTP headers, for every HTTP request made. HTTPS is mandatory</li> <li><strong>Client Side Encryption</strong>: encrypt before sending object.</li> </ul> <p>Explicit DENY in an IAM policy will take precedence over a bucket policy permission.</p> <h3 id=s3-website>S3 Website<a class=headerlink href=#s3-website title="Permanent link">&para;</a></h3> <p>We can have static web site on S3. Once html pages are uploaded, setting the properties as static web site from the bucket. The bucket needs to be public, and have a security policy to allow any user to <code>GetObject</code> action. The URL may look like: <code>&lt;bucket-name&gt;.s3-website.&lt;AWS-region&gt;.amazonaws.com</code></p> <ul> <li><strong>Cross Origin resource sharing CORS</strong>: The web browser requests won’t be fulfilled unless the other origin allows for the requests, using CORS Headers <code>Access-Control-Allow-Origin</code>. If a client does a cross-origin request on our S3 bucket, we need to enable the correct CORS headers: this is done by adding a security policy with CORS configuration like:</li> </ul> <div class=highlight><pre><span></span><code><span class=nt>&lt;CORSConfiguration&gt;</span>
    <span class=nt>&lt;CORSRule&gt;</span>
        <span class=nt>&lt;AllowedOrigin&gt;</span>enter-bucket-url-here<span class=nt>&lt;/AllowedOrigin&gt;</span>
        <span class=nt>&lt;AllowedMethod&gt;</span>GET<span class=nt>&lt;/AllowedMethod&gt;</span>
        <span class=nt>&lt;MaxAgeSeconds&gt;</span>3000<span class=nt>&lt;/MaxAgeSeconds&gt;</span>
        <span class=nt>&lt;AllowedHeader&gt;</span>Authorization<span class=nt>&lt;/AllowedHeader&gt;</span>
    <span class=nt>&lt;/CORSRule&gt;</span>
<span class=nt>&lt;/CORSConfiguration&gt;</span>
</code></pre></div> <p>Finally S3 is eventually consistent.</p> <h4 id=s3-replication>S3 replication<a class=headerlink href=#s3-replication title="Permanent link">&para;</a></h4> <p>Once versioning enabled, a bucket can be replicated in the same region or cross regions. S3 replication is done on at least 3 AZs. Each AZ can be up to 8 data centers. One DC down does not impact S3 availability. The replication is done asynchronously. SRR is for log aggregation for example, while CRR is used for compliance and DR or replication across accounts. Delete operations are not replicated.</p> <h3 id=s3-storage-classes>S3 Storage classes<a class=headerlink href=#s3-storage-classes title="Permanent link">&para;</a></h3> <p>When uploading a document into an existing bucket we can specify the storage class for keep data over time. Different levels are offered with different cost and SLA.</p> <p><img alt=A src=images/storage-class.png></p> <p>To prevent accidental file deletes, we can setup MFA Delete to use MFA tokens before deleting objects.</p> <p>Amazon <strong>Glacier</strong> is for archiving, like writing to tapes. </p> <p>We can transition objects between storage classes. For infrequently accessed object, move them to STANDARD_IA. For archive objects, that we don’t need in real-time, use GLACIER or DEEP_ARCHIVE. Moving objects can be automated using a lifecycle configuration</p> <p>At the bucket level, a user can define lifecycle rules for when to transition an object to another storage class.</p> <p><img alt=B src=images/storage-rule.png></p> <p>To improve performance, a big file can be split and then uploaded with local connection to the closed edge access and then use AWS private network to copy between buckets in different region.</p> <p><a href=https://ibm-cloud-architecture.github.io/refarch-eda/use-cases/connect-s3/ >S3 to Kafka lab</a></p> <h2 id=aws-athena>AWS Athena<a class=headerlink href=#aws-athena title="Permanent link">&para;</a></h2> <p><a href=https://aws.amazon.com/athena>AWS Athena</a> runs analytics directly on S3 files, using SQL language to query the files (CSV, JSON, Avro, Parquet...). S3 Access Logs log all the requests made to buckets, and Athena can then be used to run serverless analytics on top of the logs files. Queries are done on high availability capability so will succeed, and scale based on the data size.</p> <p>No need for complex ETL jobs to prepare your data for analytics.</p> <p>Integrated with AWS <strong>Glue Data Catalog</strong>, allowing you to create a unified metadata repository across various services, crawl data sources to discover schemas and populate your Catalog with new and modified table and partition definitions, and maintain schema versioning.</p> <h2 id=aws-cli_1>AWS CLI<a class=headerlink href=#aws-cli_1 title="Permanent link">&para;</a></h2> <p>The cli needs to be configured: <code>aws configure</code> with the credential, key and region to access. Use IAM user to get a new credentials key.</p> <p>When using CLI in a EC2 instance always use an IAM role to control security credentials. This role can come with a policy authorizing exactly what the EC2 instances should be able to do. Also within a EC2 instance, it is possible to use the URL http://169.254.169.254/latest/meta-data to get information about the EC2. We can retrieve the IAM Role name from that metadata.</p> <h2 id=cloudfront>CloudFront<a class=headerlink href=#cloudfront title="Permanent link">&para;</a></h2> <p>CDN service with DDoS protection. It caches data to the edge to improve web browsing and app performance. 216 Edge locations.</p> <p>The origins of those files are S3 buckets, Custom resource accessible via HTTP. CloudFront keeps cache for the data read. For the edge to access the S3 bucket, it uses an origin access identity (OAI), managed as IAM role.</p> <p>For EC2 instance, the security group needs to accept traffic from edge location IP addresses.</p> <p>It is possible to control with geo restriction.</p> <p>It also supports the concept of signed URL. When you want to distribute content to different user groups over the world, attach a policy with:</p> <ul> <li>URL expiration</li> <li>IP ranges to access the data from</li> <li>Trusted signers (which AWS accounts can create signed URLs)</li> <li>How long should the URL be valid for?</li> <li>Shared content (movie, music): make it short (a few minutes)</li> <li>Private content (private to the user): you can make it last for years</li> <li>Signed URL = access to individual files (one signed URL per file)</li> <li>Signed Cookies = access to multiple files (one signed cookie for many files)</li> </ul> <h2 id=storage>Storage<a class=headerlink href=#storage title="Permanent link">&para;</a></h2> <h3 id=snowball>Snowball<a class=headerlink href=#snowball title="Permanent link">&para;</a></h3> <p>Move TB of data in and out AWS using physical device to ship data. The edge has 100TB and compute power to do some local processing on data. Snow mobile is a truck with 100 PB capacity. Once on site, it is transferred to S3.</p> <p>Snowball Edge brings computing capabilities to allow data pre-processing while it's being moved in Snowball, so we save time on the pre-processing side as well.</p> <h2 id=hybrid-cloud-storage>Hybrid cloud storage<a class=headerlink href=#hybrid-cloud-storage title="Permanent link">&para;</a></h2> <p>Storage gateway expose an API in front of S3. Three gateway types:</p> <ul> <li><strong>file</strong>: S3 bucket accessible using NFS or SMB protocols. Controlled access via IAM roles. File gateway is installed on-premise and communicate with AWS.</li> <li><strong>volume</strong>: this is a block storage using iSCSI protocol. On-premise and visible as a local volume backed by S3.</li> <li><strong>tape</strong>: same approach but with virtual tape library. Can go to S3 and Glacier.</li> </ul> <h3 id=storage-comparison>Storage comparison<a class=headerlink href=#storage-comparison title="Permanent link">&para;</a></h3> <ul> <li>S3: Object Storage</li> <li>Glacier: Object Archival</li> <li>EFS: Network File System for Linux instances, POSIX filesystem</li> <li>FSx for Windows: Network File System for Windows servers</li> <li>FSx for Lustre: High Performance Computing Linux file system</li> <li>EBS volumes: Network storage for one EC2 instance at a time</li> <li>Instance Storage: Physical storage for your EC2 instance (high IOPS)</li> <li>Storage Gateway: File Gateway, Volume Gateway (cache &amp; stored), Tape Gateway</li> <li>Snowball / Snowmobile: to move large amount of data to the cloud, physically</li> <li>Database: for specific workloads, usually with indexing and querying</li> </ul> <h2 id=integration-and-middleware-sqs-kinesis-active-mq>Integration and middleware: SQS, Kinesis Active MQ<a class=headerlink href=#integration-and-middleware-sqs-kinesis-active-mq title="Permanent link">&para;</a></h2> <h3 id=sqs-standard-queue>SQS: Standard queue<a class=headerlink href=#sqs-standard-queue title="Permanent link">&para;</a></h3> <p>Oldest queueing service on AWS. The default retention is 4 days up to 14 days. low latency &lt; 10ms. Duplicate messages is possible and out of order too. Consumer deletes the message. It is auto scaling.</p> <p>Specific SDK to integrate to SendMessage...</p> <p>Consumers receive, process and then delete. Parallelism is possible on the different messages. The consumers can be in an auto scaling group so with CloudWatch, it is possible to monitor the queue size / # of instances and on the CloudWatch alarm action, trigger scaling. Max mesage size is 256KB. </p> <p>Message has metadata out of the box. After a message is polled by a consumer, it becomes invisible to other consumers. By default, the “message visibility timeout” is 30 seconds, which means the message has 30 seconds to be processed (Amazon SQS prevents other consumers from receiving and processing the message). After the message visibility timeout is over, the message is “visible” in SQS, so it may be processed twice. But a consumer could call the ChangeMessageVisibility API to get more time. When the visibility timeout is high (hours), and the consumer crashes then the re-processing of all the message will take time. If it is set too low (seconds), we may get duplicates</p> <p><img alt=SQS src=images/sqs-msg.png></p> <p>Encryption in fight via HTTPS, at rest encryption with KMS keys. Comes with monitoring.</p> <p>If a consumer fails to process a message within the Visibility Timeout, the message goes back to the queue. But if we can set a threshold of how many times a message can go back to the queue. After the MaximumReceives threshold is exceeded, the message goes into a dead letter queue (DLQ) (which has a limit of 14 days to process).</p> <p><img alt=DLQ src=images/sqs-dlq.png></p> <p>Delay queues let you postpone the delivery of new messages to a queue for a number of seconds. If you create a delay queue, any messages that you send to the queue remain invisible to consumers for the duration of the delay period. The default (minimum) delay for a queue is 0 seconds. The maximum is 15 minutes</p> <p>Queue can be set as FIFO to guaranty the order: limited to throughput at 300 msg/s without batching or 3000 msg/s with batching. I can also support exactly once. It can be set to remove duplicate by looking at the content.</p> <h3 id=simple-notification-service-is-for-topic-pubsub>Simple Notification Service is for topic pub/sub<a class=headerlink href=#simple-notification-service-is-for-topic-pubsub title="Permanent link">&para;</a></h3> <p>SNS supports up to 10,000,000 subscriptions per topic, 100,000 topics limit. The subscribers can publish to topic via SDK and can use different protocols like: HTTP / HTTPS (with delivery retries – how many times), SMTP, SMS, ... The subscribers can be a SQS, a Lambda, Emails... Many AWS services can send data directly to SNS for notifications: CloudWatch (for alarms), Auto Scaling Groups notifications, Amazon S3 (on bucket events), CloudFormation.</p> <p>SNS can be combined with SQS: Producers push once in SNS, receive in all SQS queues that they subscribed to. It is fully decoupled without any data loss. SQS allows for data persistence, delayed processing and retries. SNS cannot send messages to SQS FIFO queues.</p> <h3 id=kinesis>Kinesis<a class=headerlink href=#kinesis title="Permanent link">&para;</a></h3> <p>It is like a managed alternative to Kafka. It uses the same principle and feature set.</p> <p><img alt=kin src=images/kinesis.png></p> <p>Data can be kept up to 7 days. hability to replay data, multiple apps consume the same stream. Only one consumer per shard</p> <ul> <li><strong>Kinesis Streams</strong>: low latency streaming ingest at scale. They offer patterns for data stream processing.</li> <li><strong>Kinesis Analytics</strong>: perform real-time analytics on streams using SQL</li> <li><strong>Kinesis Firehose</strong>: load streams into S3, Redshift, ElasticSearch. No administration, auto scaling, serverless.</li> </ul> <p>One stream is made of many different shards (like Kafka partition). Capacity of 1MB/s or 1000 messages/s at write PER SHARD, and 2MB/s at read PER SHARD. Billing is per shard provisioned, can have as many shards as we want. Batching available or per message calls.</p> <p>captured Metrics are: # of incoming/outgoing bytes, # incoming/outgoing records, Write / read provisioned throughput exceeded, and iterator age ms.</p> <p>It offer a CLI to get stream, list streams, list shard...</p> <h3 id=eventbridge>EventBridge<a class=headerlink href=#eventbridge title="Permanent link">&para;</a></h3> <p><a href=https://aws.amazon.com/eventbridge/ >EventBridge</a> is a serverless event bus that makes it easier to build event-driven applications at scale using events generated from your applications, integrated Software-as-a-Service (SaaS) applications, and AWS services.</p> <p>You can ingest, filter, transform and deliver events without writing custom code. </p> <p>Integrate schema registry stores a collection of easy-to-find event schemas and enables you to download code bindings for those schemas in your IDE so you can represent events as a strongly-typed objects in your code</p> <h2 id=serverless>Serverless<a class=headerlink href=#serverless title="Permanent link">&para;</a></h2> <p>Serveless on AWS is supported by a lot of services:</p> <ul> <li><strong>AWS Lambda</strong>: Limited by time - short executions, runs on-demand, and automated scaling. Pay per call, duration and memory used.</li> <li><strong>DynamoDB</strong>: no sql db, with HA supported by replication across three AZs. millions req/s, trillions rows, 100s TB storage. low latency on read. Support event driven programming with streams: lambda function can read the stream (24h retention). Table oriented, with dynamic attribute but primary key. 400KB max size for one document. It uses the concept of Read Capacity Unit and Write CU. It supports auto-scaling and on-demand throughput. A burst credit is authorized, when empty we get ProvisionedThroughputException. Finally it use the DynamoDB Accelerator to cache data to authorize micro second latency for cached reads. Supports transactions and bulk tx with up to 10 items. </li> <li>AWS <strong>Cognito</strong>: gives users an identity to interact with the app.</li> <li> <p>AWS <strong>API Gateway</strong>: API versioning, websocket support, different environment, support authentication and authorization. Handle request throttling. Cache API response. SDK. Support different security approaches:</p> <ul> <li>IAM:<ul> <li>Great for users / roles already within your AWS account</li> <li>Handle authentication + authorization</li> <li>Leverages Sig v4</li> </ul> </li> <li>Custom Authorizer:<ul> <li>Great for 3<sup>rd</sup> party tokens</li> <li>Very flexible in terms of what IAM policy is returned</li> <li>Handle Authentication + Authorization</li> <li>Pay per Lambda invocation</li> </ul> </li> <li>Cognito User Pool:<ul> <li>You manage your own user pool (can be backed by Facebook, Google login etc…)</li> <li>No need to write any custom code</li> <li>Must implement authorization in the backend</li> </ul> </li> <li>Amazon S3</li> <li>AWS SNS &amp; SQS</li> <li>AWS Kinesis Data Firehose</li> <li>Aurora Serverless</li> <li>Step Functions</li> <li>Fargate</li> </ul> </li> </ul> <p>Lambda@Edge is used to deploy Lambda functions alongside your CloudFront CDN, it is for building more responsive applications, closer to the end user. Lambda is deployed globally. Here are some use cases: Website security and privacy, dynamic webapp at the edge, search engine optimization (SEO), intelligent route across origins and data centers, bot mitigation at the edge, real-time image transformation, A/B testing, user authentication and authorization, user prioritization, user tracking and analytics.</p> <h3 id=serverless-architecture-patterns>Serverless architecture patterns<a class=headerlink href=#serverless-architecture-patterns title="Permanent link">&para;</a></h3> <h4 id=few-write-lot-of-reads-app-todo>Few write / Lot of reads app (ToDo)<a class=headerlink href=#few-write-lot-of-reads-app-todo title="Permanent link">&para;</a></h4> <p>The mobile application access application via REST HTTPS through API gateway. This use serverless and users should be able to directly interact with s3 buckets. They first get JWT token to authenticate and the API gateway validates such token. The Gateway delegates to a Lambda function which goes to Dynamo DB.</p> <p><img alt="ToDo web app architecture" src=images/aws-app-L.png></p> <p>Each of the component supports auto scaling. To improve read throughput cache is used with DAX. Also some of the REST request could be cached in the API gateway. As the application needs to access S3 directly, Cognito generates temporary credentials with STS so the application can authenticate to S3. User's credentials are not saved on the client app. Restricted policy is set to control access to S3 too.</p> <p>To improve throughput we can add DAX as a caching layer in front of DynamoDB: this will also reduce the sizing for DynamoDB. Some of the responses can also be cached at the API gateway level.</p> <h4 id=serverless-hosted-web-site-blog>Serverless hosted web site (Blog)<a class=headerlink href=#serverless-hosted-web-site-blog title="Permanent link">&para;</a></h4> <p>The public web site should scale globally, focus to scale on read, pure static files with some writes. To secure access to S3 content, we use Origin Access Identity and Bucket policy to authorize read only from OAI.</p> <p><img alt src=images/aws-app-blog.png></p> <p>To get a welcome message sent when a user register to the app, we can add dynamoDB streams to get changes to the dynamoDB and then calls a lambda that will send an email with the Simple Email Service.</p> <p>DynamoDB Global Table can be used to expose data in different regions by using DynamoDB streams.</p> <h4 id=microservice>Microservice<a class=headerlink href=#microservice title="Permanent link">&para;</a></h4> <p>Services use REST api to communicate. The service can be dockerized and run with ECS. Integration via REST is done via API gateway and load balancer.</p> <p><img alt src=images/aws-app-ms.png></p> <h4 id=paid-content>Paid content<a class=headerlink href=#paid-content title="Permanent link">&para;</a></h4> <p>User has to pay to get content (video). We have a DB for users. This is a Serverless solution. Videos are saved in S3. To serve the video, we use Signed URL. So a lambda will build those URLs.</p> <p><img alt src=images/aws-app-video.png></p> <p>CloudFront is used to access videos globally. OAI for security so users cannot bypass it. We can't use S3 signed URL as they are not efficient for global access.</p> <h4 id=software-update-distribution>Software update distribution<a class=headerlink href=#software-update-distribution title="Permanent link">&para;</a></h4> <p>The EC2 will be deployed in multi-zones and all is exposed with CloudFront to cache.</p> <h4 id=big-data-pipeline>Big Data pipeline<a class=headerlink href=#big-data-pipeline title="Permanent link">&para;</a></h4> <p>The solution applies the traditional collect, inject, transform and query pattern.</p> <p><img alt src=images/aws-big-data.png></p> <p>IoT Core allows to collect data from IoT devices. Kinesis is used to get data as streams, and then FireHose upload every minute to S3. A Lambda can already do transformation from FireHose. As new files are added to S3 bucket, it trigger a Lambda to call queries defined in Athena. Athena pull the data and build a report published to another S3 bucket that will be used by QuickSight to visualize the data.</p> <h2 id=other-database-considerations>Other Database considerations<a class=headerlink href=#other-database-considerations title="Permanent link">&para;</a></h2> <h3 id=redshift>Redshift<a class=headerlink href=#redshift title="Permanent link">&para;</a></h3> <p>It is based on Postgresql. but not used for OLTP, it is used for analytical processing and data warehousing, scale to PBs. It is Columnar storage of data. It uses massively parallel query execution.</p> <p>Data can be loaded from S3, DynamoDB, DMS and other DBs. It can scale from 1 to 128 nodes, and each node has 160GB per node.</p> <p>The architecture is based on a leader node to support query planning and aggregate results, and compute nodes to perform the queries and send results back.</p> <p>Redshift spectrum performs queries directly on top of S3.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=infra/ class="md-footer__link md-footer__link--next" aria-label="Next: Infrastructure" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Infrastructure </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": ["content.code.annotate", "content.tooltips", "navigation.instant", "navigation.sections", "navigation.expand", "navigation.tabs.sticky"], "search": "assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=assets/javascripts/bundle.37e9125f.min.js></script> </body> </html>